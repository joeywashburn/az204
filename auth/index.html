
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../cosmos/">
      
      
        <link rel="next" href="../secure/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Implement user authentication and authorization - AZ-204 Study Materials</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#implement-user-authentication-and-authorization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AZ-204 Study Materials" class="md-header__button md-logo" aria-label="AZ-204 Study Materials" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AZ-204 Study Materials
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Implement user authentication and authorization
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AZ-204 Study Materials" class="md-nav__button md-logo" aria-label="AZ-204 Study Materials" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AZ-204 Study Materials
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Develop Azure compute solutions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Develop Azure compute solutions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../acr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implement containerized solutions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webapp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implement Azure App Service Web Apps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implement Azure Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Develop for Azure storage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Develop for Azure storage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Develop solutions that use Azure Blob Storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cosmos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Develop solutions that use Azure Cosmos DB
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Implement Azure security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Implement Azure security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Implement user authentication and authorization
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Implement user authentication and authorization
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-entra-id-app-registration-in-microsoft-365-developer-tenant" class="md-nav__link">
    <span class="md-ellipsis">
      Set Up Entra ID App Registration in Microsoft 365 Developer Tenant
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-webapp-for-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Update WebApp for Authentication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-and-implement-shared-access-signatures-sas" class="md-nav__link">
    <span class="md-ellipsis">
      Create and Implement Shared Access Signatures (SAS)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create and Implement Shared Access Signatures (SAS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps" class="md-nav__link">
    <span class="md-ellipsis">
      Steps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-solutions-that-interact-with-microsoft-graph" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Solutions that Interact with Microsoft Graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implement Solutions that Interact with Microsoft Graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps_1" class="md-nav__link">
    <span class="md-ellipsis">
      Steps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clean-up-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Clean Up (Optional)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../secure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implement secure Azure solutions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Monitor and troubleshoot Azure solutions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Monitor and troubleshoot Azure solutions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appinsights/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitor and troubleshoot solutions by using Application Insights
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Connect to and consume Azure services and third-party services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Connect to and consume Azure services and third-party services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implement API Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Develop event-based solutions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../message/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Develop message-based solutions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-entra-id-app-registration-in-microsoft-365-developer-tenant" class="md-nav__link">
    <span class="md-ellipsis">
      Set Up Entra ID App Registration in Microsoft 365 Developer Tenant
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-webapp-for-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Update WebApp for Authentication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-and-implement-shared-access-signatures-sas" class="md-nav__link">
    <span class="md-ellipsis">
      Create and Implement Shared Access Signatures (SAS)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create and Implement Shared Access Signatures (SAS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps" class="md-nav__link">
    <span class="md-ellipsis">
      Steps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-solutions-that-interact-with-microsoft-graph" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Solutions that Interact with Microsoft Graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implement Solutions that Interact with Microsoft Graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps_1" class="md-nav__link">
    <span class="md-ellipsis">
      Steps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clean-up-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Clean Up (Optional)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="implement-user-authentication-and-authorization">Implement User Authentication and Authorization</h1>
<p>This guide covers the AZ-204 exam topics for implementing user authentication and authorization:</p>
<ul>
<li>Authenticate and authorize users by using the Microsoft Identity platform</li>
<li>Authenticate and authorize users and apps by using Microsoft Entra ID</li>
<li>Create and implement shared access signatures</li>
<li>Implement solutions that interact with Microsoft Graph</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li><strong>.NET SDK 8.0</strong> (<a href="https://learn.microsoft.com/en-us/dotnet/core/install/windows?tabs=net80#install-with-windows-package-manager-winget">Install via winget</a>: `winget install Microsoft.DotNet.SDK.8))</li>
<li><strong>Azure CLI</strong> (<a href="https://learn.microsoft.com/en-us/cli/azure/install-azure-cli">Install</a>)</li>
<li><strong>Azure Functions Core Tools</strong> (<a href="https://github.com/Azure/azure-functions-core-tools/releases">Install</a>)</li>
<li><strong>Azure Subscription</strong> (WGU Student Azure account with resource group <code>az204exam</code>)</li>
<li><strong>Microsoft 365 Developer Program Subscription</strong> (provides Microsoft Entra ID access)</li>
</ul>
<h2 id="set-up-entra-id-app-registration-in-microsoft-365-developer-tenant">Set Up Entra ID App Registration in Microsoft 365 Developer Tenant</h2>
<p><em>Note</em>: Your WebApp (<code>taskmanagerweb-yourname</code>) is hosted in your WGU Azure tenant, but you'll authenticate users from your Microsoft 365 Developer tenant. We'll configure the app registration as <strong>multitenant</strong> to enable cross-tenant authentication.</p>
<p>Follow these steps to set up an Entra ID app registration:</p>
<ol>
<li>
<p>Log in to the Microsoft 365 Developer tenant.</p>
</li>
<li>
<p>Create an app registration.</p>
</li>
<li>
<p>Verify authentication settings.</p>
</li>
<li>
<p>Get the tenant domain.</p>
</li>
</ol>
<p><strong>Step 1: Log In to the Microsoft 365 Developer Tenant</strong></p>
<p>Log in to the Azure Portal (<code>https://portal.azure.com</code>) using your personal email address (the one used for the Microsoft 365 Developer Program). Ensure you're in the correct tenant by checking the tenant name in the top-right corner (e.g., <code>yourtenant.onmicrosoft.com</code>). If needed, switch tenants by clicking your profile and selecting the Microsoft 365 Developer tenant.</p>
<p><strong>Step 2: Create App Registration</strong></p>
<p>In the Azure Portal for your Microsoft 365 Developer tenant, go to <strong>Microsoft Entra ID</strong> &gt; <strong>App registrations</strong> &gt; <strong>New registration</strong>. Configure:</p>
<ul>
<li>Name: <code>TaskManagerWebApp</code>.</li>
<li>Supported account types: Select <strong>Accounts in any organizational directory (Any Microsoft Entra ID tenant - Multitenant)</strong> to allow cross-tenant authentication.</li>
<li>Redirect URI:</li>
<li>Local: <code>https://localhost:5001/signin-oidc</code> (adjust port if different).</li>
<li>Azure: <code>https://taskmanagerweb-yourname.azurewebsites.net/signin-oidc</code> (after deployment).</li>
<li>Click <strong>Register</strong>.</li>
<li>Note the <strong>Application (client) ID</strong> and <strong>Directory (tenant) ID</strong>.</li>
</ul>
<p><strong>Step 3: Verify Authentication Settings</strong></p>
<p>In the app registration, go to <strong>Authentication</strong>:</p>
<ul>
<li>Ensure the <strong>Web</strong> platform is selected with the redirect URI.</li>
<li>Enable <strong>ID tokens</strong> (under <strong>Implicit grant and hybrid flows</strong>).</li>
</ul>
<p><strong>Step 4: Get Tenant Domain</strong></p>
<p>In <strong>Microsoft Entra ID</strong> &gt; <strong>Overview</strong>, note the <strong>Primary domain</strong> (e.g., <code>yourtenant.onmicrosoft.com</code>).</p>
<h2 id="update-webapp-for-authentication">Update WebApp for Authentication</h2>
<p><em>Note</em>: We’ll modify our <code>TaskManagerWeb</code> WebApp (hosted in your WGU Azure tenant) to authenticate users from your Microsoft 365 Developer tenant using Microsoft Entra ID.</p>
<p>Follow these steps to update the WebApp for authentication:</p>
<ol>
<li>
<p>Add the Microsoft Identity package.</p>
</li>
<li>
<p>Configure authentication settings.</p>
</li>
<li>
<p>Update the Program.cs file.</p>
</li>
<li>
<p>Create or update the controller.</p>
</li>
<li>
<p>Update the Razor view with sign-in/out links.</p>
</li>
<li>
<p>Test locally.</p>
</li>
<li>
<p>Deploy and test in Azure (optional).</p>
</li>
</ol>
<p><strong>Step 1: Add Microsoft Identity Package</strong></p>
<p>Open a terminal in your <code>TaskManagerWeb</code> project folder and run:</p>
<pre><code class="language-bash">dotnet add package Microsoft.Identity.Web
</code></pre>
<p><strong>Step 2: Configure Settings</strong></p>
<p>Update <code>appsettings.json</code>:</p>
<pre><code class="language-json">{
  &quot;AzureAd&quot;: {
    &quot;Instance&quot;: &quot;https://login.microsoftonline.com/&quot;,
    &quot;Domain&quot;: &quot;yourtenant.onmicrosoft.com&quot;,
    &quot;TenantId&quot;: &quot;common&quot;, // Use &quot;common&quot; for multitenant apps
    &quot;ClientId&quot;: &quot;your-client-id&quot;,
    &quot;CallbackPath&quot;: &quot;/signin-oidc&quot;
  },
  &quot;Logging&quot;: {
    &quot;LogLevel&quot;: {
      &quot;Default&quot;: &quot;Information&quot;,
      &quot;Microsoft.AspNetCore&quot;: &quot;Warning&quot;
    }
  },
  &quot;AllowedHosts&quot;: &quot;*&quot;
}
</code></pre>
<p>Replace <code>yourtenant.onmicrosoft.com</code> with your Microsoft 365 Developer tenant domain and <code>your-client-id</code> with the Application (client) ID from the app registration. Use <code>"TenantId": "common"</code> to allow authentication from any tenant, as the app is multitenant.</p>
<p><strong>Step 3: Update Program.cs</strong></p>
<p>Modify <code>Program.cs</code> to add authentication services:</p>
<pre><code class="language-csharp">using Microsoft.Identity.Web;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
builder.Services.AddRazorPages();
builder.Services.AddControllersWithViews();

// Add Microsoft Identity authentication
builder.Services.AddAuthentication(OpenIdConnectDefaults.AuthenticationScheme)
    .AddMicrosoftIdentityWebApp(builder.Configuration.GetSection(&quot;AzureAd&quot;));

builder.Services.AddAuthorization();

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler(&quot;/Error&quot;);
    app.UseHsts();
}

app.UseHttpsRedirection();
app.UseStaticFiles();

app.UseRouting();

app.UseAuthentication();
app.UseAuthorization();

app.MapRazorPages();
app.MapControllers();

app.Run();
</code></pre>
<p><strong>Step 4: Create or Update Controller</strong></p>
<p>Since your WebApp uses a Razor view with <code>@model List&lt;TaskManagerWeb.Models.TaskItem&gt;</code>, we’ll create a controller to handle it.</p>
<p>Create <code>Models/TaskItem.cs</code> (if not already present):</p>
<pre><code class="language-csharp">namespace TaskManagerWeb.Models
{
    public class TaskItem
    {
        public string Title { get; set; }
        public string Description { get; set; }
        public string DueDate { get; set; }
    }
}
</code></pre>
<p>Create <code>Controllers/HomeController.cs</code>:</p>
<pre><code class="language-csharp">using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;
using TaskManagerWeb.Models;
using System.Collections.Generic;

namespace TaskManagerWeb.Controllers
{
    [Authorize] // Require login
    public class HomeController : Controller
    {
        public IActionResult Index()
        {
            // Mock task list (replace with Cosmos DB later)
            var tasks = new List&lt;TaskItem&gt;
            {
                new TaskItem { Title = &quot;Sample Task&quot;, Description = &quot;Test auth&quot;, DueDate = &quot;2025-04-15&quot; }
            };
            return View(tasks);
        }

        [HttpPost]
        public IActionResult Create(string title, string description, string dueDate)
        {
            // Add task logic (e.g., save to Cosmos DB)
            // For now, redirect back to index
            return RedirectToAction(&quot;Index&quot;);
        }

        public IActionResult SignOut()
        {
            return SignOut(&quot;Cookies&quot;, OpenIdConnectDefaults.AuthenticationScheme);
        }
    }
}
</code></pre>
<p><strong>Step 5: Update Razor View</strong></p>
<p>Ensure your view is at <code>Views/Home/Index.cshtml</code>. Update it to show user info and sign-in/out links:</p>
<pre><code class="language-html">@model List&lt;TaskManagerWeb.Models.TaskItem&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;!-- Your existing CSS --&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Task Manager&lt;/h1&gt;
    @if (User.Identity.IsAuthenticated)
    {
        &lt;p&gt;Welcome, @User.Identity.Name! &lt;a asp-controller=&quot;Home&quot; asp-action=&quot;SignOut&quot;&gt;Sign Out&lt;/a&gt;&lt;/p&gt;
    }
    else
    {
        &lt;p&gt;&lt;a href=&quot;/MicrosoftIdentity/Account/SignIn&quot;&gt;Sign In&lt;/a&gt;&lt;/p&gt;
    }

    &lt;form asp-action=&quot;Create&quot; method=&quot;post&quot;&gt;
        &lt;div&gt;
            &lt;label&gt;Title:&lt;/label&gt;
            &lt;input type=&quot;text&quot; name=&quot;title&quot; required /&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;label&gt;Description:&lt;/label&gt;
            &lt;textarea name=&quot;description&quot;&gt;&lt;/textarea&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;label&gt;Due Date:&lt;/label&gt;
            &lt;input type=&quot;date&quot; name=&quot;dueDate&quot; required /&gt;
        &lt;/div&gt;
        &lt;button type=&quot;submit&quot;&gt;Add Task&lt;/button&gt;
    &lt;/form&gt;

    &lt;h2&gt;Tasks&lt;/h2&gt;
    &lt;ul&gt;
        @if (Model != null &amp;&amp; Model.Any())
        {
            foreach (var task in Model)
            {
                &lt;li&gt;
                    &lt;div class=&quot;task-info&quot;&gt;
                        &lt;strong&gt;@task.Title&lt;/strong&gt; - @task.Description
                        &lt;br /&gt;
                        &lt;small&gt;Due: @(task.DueDate ?? &quot;No due date&quot;)&lt;/small&gt;
                    &lt;/div&gt;
                &lt;/li&gt;
            }
        }
        else
        {
            &lt;li class=&quot;no-tasks&quot;&gt;No tasks yet.&lt;/li&gt;
        }
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><strong>Step 6: Test Locally</strong></p>
<p>Run the WebApp locally:</p>
<pre><code class="language-bash">cd TaskManagerWeb
dotnet run
</code></pre>
<p>Access <code>https://localhost:5001</code> (adjust port if different). Expect a redirect to <code>https://login.microsoftonline.com/...</code> for login. Sign in with a user from your Microsoft 365 Developer tenant (e.g., an admin or user account created in your Microsoft 365 Developer sandbox). After login, see the Task Manager with “Welcome, [Your Name]!”.</p>
<p>Verify:</p>
<ul>
<li>Without login, you can’t access the task list.</li>
<li>After login, you see tasks and can submit the form.</li>
<li>Click <strong>Sign Out</strong> to end the session.</li>
</ul>
<p><strong>Step 7: Deploy and Test (Optional)</strong></p>
<p>Deploy to Azure (in your WGU Azure tenant):</p>
<pre><code class="language-bash">az webapp up --name taskmanagerweb-yourname --resource-group az204exam
</code></pre>
<p>Update the redirect URI in the app registration (Microsoft 365 Developer tenant) to <code>https://taskmanagerweb-yourname.azurewebsites.net/signin-oidc</code>. Test at <code>https://taskmanagerweb-yourname.azurewebsites.net</code>. Sign in with a Microsoft 365 Developer tenant user.</p>
<h2 id="create-and-implement-shared-access-signatures-sas">Create and Implement Shared Access Signatures (SAS)</h2>
<p>Shared Access Signatures (SAS) allow you to grant limited access to Azure Blob Storage resources. We'll create a SAS token for a container and use it to upload a file.</p>
<h3 id="steps">Steps</h3>
<p>Follow these steps to implement SAS:</p>
<ol>
<li>
<p>Create a Blob Storage account and container.</p>
</li>
<li>
<p>Generate a SAS token for the container.</p>
</li>
<li>
<p>Use the SAS token to upload a file.</p>
</li>
</ol>
<p><strong>Step 1: Create a Blob Storage Account and Container</strong></p>
<p>Use the Azure CLI to create a storage account and container (if not already created in previous sections):</p>
<pre><code class="language-bash">az storage account create --name taskmanagerstorage --resource-group az204exam --location westus --sku Standard_LRS
az storage container create --name tasks --account-name taskmanagerstorage
</code></pre>
<p><strong>Step 2: Generate a SAS Token</strong></p>
<p>Generate a SAS token with write permissions for the <code>tasks</code> container.</p>
<pre><code class="language-bash">expiry=$(date -u -d &quot;1 hour&quot; '+%Y-%m-%dT%H:%MZ')
sas=$(az storage container generate-sas --account-name taskmanagerstorage --name tasks --permissions rw --expiry $expiry --output tsv)
echo &quot;SAS Token: $sas&quot;
</code></pre>
<p><strong>Step 3: Use the SAS Token to Upload a File</strong></p>
<p>Create a test file and upload it using the SAS token.</p>
<pre><code class="language-bash">echo &quot;Test file content&quot; &gt; testfile.txt
az storage blob upload --account-name taskmanagerstorage --container-name tasks --name testfile.txt --file testfile.txt --sas-token &quot;$sas&quot;
</code></pre>
<p>Verify the upload in the Azure Portal under your storage account &gt; <strong>Containers</strong> &gt; <code>tasks</code>.</p>
<h2 id="implement-solutions-that-interact-with-microsoft-graph">Implement Solutions that Interact with Microsoft Graph</h2>
<p>With Entra ID access through your Microsoft 365 Developer tenant, we can interact with Microsoft Graph to fetch user profile data and display it in the WebApp.</p>
<h3 id="steps_1">Steps</h3>
<p>Follow these steps to interact with Microsoft Graph:</p>
<ol>
<li>
<p>Grant Microsoft Graph permissions to the app registration.</p>
</li>
<li>
<p>Add the Microsoft Graph SDK to the WebApp.</p>
</li>
<li>
<p>Update the controller to fetch user profile data.</p>
</li>
<li>
<p>Update the Razor view to display the Graph data.</p>
</li>
<li>
<p>Test locally.</p>
</li>
</ol>
<p><strong>Step 1: Grant Microsoft Graph Permissions</strong></p>
<p>In the Azure Portal (Microsoft 365 Developer tenant), go to <strong>Microsoft Entra ID</strong> &gt; <strong>App registrations</strong> &gt; <code>TaskManagerWebApp</code> &gt; <strong>API permissions</strong>:</p>
<ul>
<li>Click <strong>Add a permission</strong> &gt; <strong>Microsoft Graph</strong> &gt; <strong>Delegated permissions</strong>.</li>
<li>Select <code>User.Read</code> (to read the signed-in user's profile).</li>
<li>Click <strong>Add permissions</strong>.</li>
<li>If required, click <strong>Grant admin consent for [your tenant]</strong> to apply the permissions.</li>
</ul>
<p><strong>Step 2: Add Microsoft Graph SDK</strong></p>
<p>In the <code>TaskManagerWeb</code> directory, add the Microsoft Graph SDK:</p>
<pre><code class="language-bash">dotnet add package Microsoft.Graph
dotnet add package Microsoft.Identity.Web.MicrosoftGraph
</code></pre>
<p><strong>Step 3: Update the Controller</strong></p>
<p>Update <code>Controllers/HomeController.cs</code> to fetch user profile data using Microsoft Graph:</p>
<pre><code class="language-csharp">using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;
using TaskManagerWeb.Models;
using System.Collections.Generic;
using Microsoft.Graph;

namespace TaskManagerWeb.Controllers
{
    [Authorize]
    public class HomeController : Controller
    {
        private readonly GraphServiceClient _graphClient;

        public HomeController(GraphServiceClient graphClient)
        {
            _graphClient = graphClient;
        }

        public async Task&lt;IActionResult&gt; Index()
        {
            // Fetch user profile from Microsoft Graph
            var user = await _graphClient.Me.Request().GetAsync();
            ViewBag.UserProfile = new { DisplayName = user.DisplayName, Email = user.Mail ?? user.UserPrincipalName };

            // Mock task list (replace with Cosmos DB later)
            var tasks = new List&lt;TaskItem&gt;
            {
                new TaskItem { Title = &quot;Sample Task&quot;, Description = &quot;Test auth&quot;, DueDate = &quot;2025-04-15&quot; }
            };
            return View(tasks);
        }

        [HttpPost]
        public IActionResult Create(string title, string description, string dueDate)
        {
            // Add task logic (e.g., save to Cosmos DB)
            // For now, redirect back to index
            return RedirectToAction(&quot;Index&quot;);
        }

        public IActionResult SignOut()
        {
            return SignOut(&quot;Cookies&quot;, OpenIdConnectDefaults.AuthenticationScheme);
        }
    }
}
</code></pre>
<p>Update <code>Program.cs</code> to add the Graph client:</p>
<pre><code class="language-csharp">using Microsoft.Identity.Web;

var builder = WebApplication.CreateBuilder(args);

// Add services to the container.
builder.Services.AddRazorPages();
builder.Services.AddControllersWithViews();

// Add Microsoft Identity authentication and Microsoft Graph
builder.Services.AddAuthentication(OpenIdConnectDefaults.AuthenticationScheme)
    .AddMicrosoftIdentityWebApp(builder.Configuration.GetSection(&quot;AzureAd&quot;))
    .EnableTokenAcquisitionToCallDownstreamApi(new string[] { &quot;User.Read&quot; })
    .AddMicrosoftGraph(&quot;https://graph.microsoft.com/v1.0&quot;)
    .AddInMemoryTokenCaches();

builder.Services.AddAuthorization();

var app = builder.Build();

// Configure the HTTP request pipeline.
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler(&quot;/Error&quot;);
    app.UseHsts();
}

app.UseHttpsRedirection();
app.UseStaticFiles();

app.UseRouting();

app.UseAuthentication();
app.UseAuthorization();

app.MapRazorPages();
app.MapControllers();

app.Run();
</code></pre>
<p><strong>Step 4: Update the Razor View</strong></p>
<p>Update <code>Views/Home/Index.cshtml</code> to display the Microsoft Graph user profile data:</p>
<pre><code class="language-html">@model List&lt;TaskManagerWeb.Models.TaskItem&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;!-- Your existing CSS --&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Task Manager&lt;/h1&gt;
    @if (User.Identity.IsAuthenticated)
    {
        &lt;p&gt;Welcome, @User.Identity.Name! (Graph Profile: @ViewBag.UserProfile.DisplayName, @ViewBag.UserProfile.Email) &lt;a asp-controller=&quot;Home&quot; asp-action=&quot;SignOut&quot;&gt;Sign Out&lt;/a&gt;&lt;/p&gt;
    }
    else
    {
        &lt;p&gt;&lt;a href=&quot;/MicrosoftIdentity/Account/SignIn&quot;&gt;Sign In&lt;/a&gt;&lt;/p&gt;
    }

    &lt;form asp-action=&quot;Create&quot; method=&quot;post&quot;&gt;
        &lt;div&gt;
            &lt;label&gt;Title:&lt;/label&gt;
            &lt;input type=&quot;text&quot; name=&quot;title&quot; required /&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;label&gt;Description:&lt;/label&gt;
            &lt;textarea name=&quot;description&quot;&gt;&lt;/textarea&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;label&gt;Due Date:&lt;/label&gt;
            &lt;input type=&quot;date&quot; name=&quot;dueDate&quot; required /&gt;
        &lt;/div&gt;
        &lt;button type=&quot;submit&quot;&gt;Add Task&lt;/button&gt;
    &lt;/form&gt;

    &lt;h2&gt;Tasks&lt;/h2&gt;
    &lt;ul&gt;
        @if (Model != null &amp;&amp; Model.Any())
        {
            foreach (var task in Model)
            {
                &lt;li&gt;
                    &lt;div class=&quot;task-info&quot;&gt;
                        &lt;strong&gt;@task.Title&lt;/strong&gt; - @task.Description
                        &lt;br /&gt;
                        &lt;small&gt;Due: @(task.DueDate ?? &quot;No due date&quot;)&lt;/small&gt;
                    &lt;/div&gt;
                &lt;/li&gt;
            }
        }
        else
        {
            &lt;li class=&quot;no-tasks&quot;&gt;No tasks yet.&lt;/li&gt;
        }
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><strong>Step 5: Test Locally</strong></p>
<p>Run the WebApp locally:</p>
<pre><code class="language-bash">cd TaskManagerWeb
dotnet run
</code></pre>
<p>Sign in with a Microsoft 365 Developer tenant user at <code>https://localhost:5001</code>. After login, you should see the Graph profile data (e.g., “Graph Profile: [Your Name], [Your Email]”) alongside the welcome message.</p>
<h2 id="clean-up-optional">Clean Up (Optional)</h2>
<p>To avoid costs, delete all resources:</p>
<pre><code class="language-bash">az group delete -n az204exam --no-wait --yes
</code></pre>
<h2 id="next-steps">Next Steps</h2>
<ul>
<li>Explore other Microsoft Graph APIs (e.g., fetching calendar events or emails).</li>
<li>Integrate with Cosmos DB for persistent task storage (as done in previous sections).</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>