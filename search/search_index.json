{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"app1/","title":"Task Management Web App","text":"<p>A simple task management web application built with .NET, hosted on Azure App Service, using Azure Cosmos DB for storage, Azure Active Directory (AAD) for authentication, and Azure Monitor for insights. This project demonstrates key Azure services and concepts covered in the AZ-204 certification, including compute, storage, security, and monitoring.</p>"},{"location":"app1/#architecture","title":"Architecture","text":"<ul> <li>Frontend: .NET Core MVC (or React) hosted on Azure App Service.</li> <li>Backend: Azure Functions for serverless API endpoints handling CRUD operations.</li> <li>Database: Azure Cosmos DB (Core SQL API) for storing task data.</li> <li>Storage: Azure Blob Storage for task attachments (e.g., images).</li> <li>Authentication: Azure Active Directory for secure user login.</li> <li>Monitoring: Application Insights for performance telemetry.</li> </ul>"},{"location":"app1/#az-204-topics-covered","title":"AZ-204 Topics Covered","text":"<ul> <li>Compute: Azure App Service Web Apps, Azure Functions.</li> <li>Storage: Azure Cosmos DB, Azure Blob Storage.</li> <li>Security: Azure AD authentication, role-based access control (RBAC).</li> <li>Monitoring: Application Insights for telemetry and diagnostics.</li> <li>Integration: Consuming Azure services via SDKs.</li> </ul>"},{"location":"app1/#prerequisites","title":"Prerequisites","text":"<ul> <li>.NET SDK 8.0 (Install via winget: <code>winget install Microsoft.DotNet.SDK.8</code>)</li> <li>Azure CLI (Install)</li> <li>Azure Functions Core Tools (Install)</li> <li>Azure Subscription (Free tier or $200 credit recommended for minimal costs)</li> </ul>"},{"location":"app1/#getting-started","title":"Getting Started","text":"<p>Follow these steps to set up and deploy the app locally and on Azure (~2.5 hours total).</p>"},{"location":"app1/#1-set-up-azure-app-service","title":"1. Set Up Azure App Service","text":"<ol> <li>In the Azure Portal, create a new App Service:</li> <li>Use the Free F1 tier to avoid costs.</li> <li>Note the app name (e.g., <code>taskmanagerweb-yourname</code>) and resource group (e.g., <code>az204exam</code>).</li> <li>Check out the tabs for learning experience, we are leaving them default</li> </ol> <p> 2. Create a .NET Core MVC app locally:    <code>bash    dotnet new mvc -o TaskManagerWeb    cd TaskManagerWeb    dotnet run</code> 3. Verify the app runs at http://localhost:port 4. Launch your editor of choice:    <code>bash    code.</code> 5. Browse into the Models directory under TaskManagerWeb. 6. Add TaskItem.cs:     <code>csharp         namespace TaskManagerWeb.Models         {             public class TaskItem             {                 public string id { get; set; } = System.Guid.NewGuid().ToString();                 public string? Title { get; set; }                 public string? Description { get; set; }                 public string? DueDate { get; set; } // Changed to string             }         }</code> 7. Update Controllers/HomeController.cs to handle tasks (in-memory for now):     ```csharp     using Microsoft.AspNetCore.Mvc;     using TaskManagerWeb.Models;     using System.Collections.Generic;</p> <pre><code>namespace TaskManagerWeb.Controllers\n{\n    public class HomeController : Controller\n    {\n        private static List&lt;TaskItem&gt; _tasks = new List&lt;TaskItem&gt;();\n\n        public IActionResult Index()\n        {\n            return View(_tasks);\n        }\n\n        [HttpPost]\n        public IActionResult Create(string title, string description, DateTime dueDate)\n        {\n            var task = new TaskItem\n            {\n                Title = title,\n                Description = description,\n                DueDate = dueDate.ToString(\"yyyy-MM-dd\") // Convert DateTime to string\n            };\n            _tasks.Add(task);\n            return RedirectToAction(\"Index\");\n        }\n    }\n}\n```\n</code></pre>"},{"location":"app1/#modify-the-home-page-view-to-add-a-form-5-min","title":"Modify the Home Page View to Add a Form (~5 min):","text":"<p>The view (Index.cshtml) defines the UI, including the form for adding tasks and a list to display them. 1. Open Views/Home/Index.cshtml. Replace the default content with:</p> <pre><code>@model List&lt;TaskManagerWeb.Models.TaskItem&gt;\n\n&lt;h1&gt;Task Manager&lt;/h1&gt;\n\n&lt;form asp-action=\"Create\" method=\"post\"&gt;\n    &lt;div&gt;\n        &lt;label&gt;Title:&lt;/label&gt;\n        &lt;input type=\"text\" name=\"title\" required /&gt;\n    &lt;/div&gt;\n    &lt;div&gt;\n        &lt;label&gt;Description:&lt;/label&gt;\n        &lt;textarea name=\"description\"&gt;&lt;/textarea&gt;\n    &lt;/div&gt;\n    &lt;div&gt;\n        &lt;label&gt;Due Date:&lt;/label&gt;\n        &lt;input type=\"date\" name=\"dueDate\" required /&gt;\n    &lt;/div&gt;\n    &lt;button type=\"submit\"&gt;Add Task&lt;/button&gt;\n&lt;/form&gt;\n\n&lt;h2&gt;Tasks&lt;/h2&gt;\n&lt;ul&gt;\n    @if (Model != null &amp;&amp; Model.Any())\n    {\n        foreach (var task in Model)\n        {\n            &lt;li&gt;@task.Title - @task.Description (Due: @(task.DueDate ?? \"No due date\"))&lt;/li&gt;\n        }\n    }\n    else\n    {\n        &lt;li&gt;No tasks yet.&lt;/li&gt;\n    }\n&lt;/ul&gt;\n</code></pre> <ol> <li>Test the app works locally</li> </ol> <pre><code>dotnet run\n</code></pre>"},{"location":"app1/#deploy-to-azure-app-service","title":"Deploy to Azure App Service","text":"<ol> <li>Push the app you created up to the Azure App Service we previously made.</li> </ol> <pre><code>az webapp up --name taskmanagerweb-yourname --resource-group az204exam --sku F1 --location yourlocation\n</code></pre> <ol> <li>Test the app in your browser.  You should be able to get the URL from the App Service Overview page</li> </ol>"},{"location":"app1/#you-have-completed-the-set-up-azure-app-service-section","title":"You have completed the Set Up Azure App Service section.","text":""},{"location":"app1/#create-azure-functions-for-apis","title":"Create Azure Functions for APIs","text":"<p>In the Azure Portal, create a new Function App: - Check out the tabs for learning experience, we are leaving them default</p> <p></p> <ol> <li>From your root directory build your function</li> </ol> <pre><code>func init TaskManagerFunctions --dotnet\n</code></pre> <ol> <li>Move into the TaskManagerFunctions dir</li> </ol> <pre><code>cd TaskManagerFunctions\n</code></pre> <ol> <li>Build the function</li> </ol> <pre><code>func new --template \"HttpTrigger\" --name CreateTask\n</code></pre> <ol> <li>Test your function locally first</li> </ol> <pre><code>func start\n</code></pre> <p>You should see output like</p> <pre><code>Functions:\n    CreateTask: [GET,POST] http://localhost:7071/api/CreateTask\n</code></pre> <p>Open a browser and go to:</p> <pre><code>http://localhost:7071/api/CreateTask?name=Test\n</code></pre> <p>Expected response should be something like this:</p> <pre><code>This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response.\n</code></pre> <ol> <li>Deploy to Azure: </li> </ol> <pre><code>func azure functionapp publish taskmanagerfunc-yourname #replace with your function name\n</code></pre> <p>Watch for the \u201cFunctions in taskmanagerfunc-yourname\u201d section in the output. It should list:</p> <pre><code>Functions in taskmanagerfunc-yourname:\n    CreateTask - [httpTrigger]\n        Invoke url: https://taskmanagerfunc-yourname.azurewebsites.net/api/createtask?code=...\n</code></pre> <ol> <li>Retrieve the Function Key</li> </ol> <pre><code>az functionapp function keys list --resource-group az204exam --name taskmanagerfunc-yourname --function-name CreateTask\n</code></pre> <ol> <li> <p>Save the default key value.  We are going to use it in the next step.</p> </li> <li> <p>Test it out:</p> </li> <li>Construct the URL you need to test</li> <li>Take your invoke url from Step 5 and append your default key.  It should look something like this</li> </ol> <pre><code>https://taskmanagerfunc-jwashburn.azurewebsites.net/api/createtask?code=THISISYOURCODEFROMSTEP7&amp;name=Test\n</code></pre> <ul> <li>You should see something like:</li> </ul> <pre><code>Hello, Test. This HTTP triggered function executed successfully.\n</code></pre>"},{"location":"app1/#you-have-completed-the-set-up-azure-functions-for-api-section","title":"You have completed the Set Up Azure Functions for API section.","text":""},{"location":"app1/#set-up-cosmos-db","title":"Set Up Cosmos DB","text":"<ol> <li>In the Portal, go to \u201cAzure Cosmos DB\u201d &gt; \u201cCreate.  Choose NoSQL API\u201d</li> <li>Choose your settings.  You can refer to the sceenshot for details.  Again flip through the tabs to see what is there, but leave defaults</li> </ol>"},{"location":"app1/#create-database-and-container","title":"Create Database and Container","text":"<ul> <li>In the Cosmos DB account, go to \u201cData Explorer.\u201d</li> <li>New Database: TasksDB.</li> <li>New Container: Use Existing &gt; Choose TasksDB Tasks, Partition Key: /id, Throughput: 400 RU/s</li> </ul>"},{"location":"app1/#get-connection-strings","title":"Get Connection Strings:","text":"<ul> <li>Go to Settings&gt; Keys copy the Primary Connection String.  Save them we are going to need them in a minute.</li> </ul>"},{"location":"app1/#you-have-completed-the-set-up-cosmos-dbsection","title":"You have completed the Set Up Cosmos DBsection.","text":""},{"location":"app1/#update-the-function-to-use-cosmos-db","title":"Update the Function to Use Cosmos DB","text":"<ul> <li>Modify the CreateTask Function to save tasks to Cosmos DB.</li> </ul>"},{"location":"app1/#add-the-cosmos-db-sdk","title":"Add the Cosmos DB SDK:","text":"<ol> <li>In the TaskManagerFunctions directory</li> </ol> <pre><code>cd TaskManagerFunctions\ndotnet add package Microsoft.Azure.Cosmos\ndotnet add package Microsoft.Azure.WebJobs.Extensions.CosmosDB\n</code></pre> <ol> <li>Update CreateTask.cs</li> <li>Replace the existing code with:</li> </ol> <pre><code>using System.Threading.Tasks;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.Azure.WebJobs;\nusing Microsoft.Azure.WebJobs.Extensions.Http;\nusing Microsoft.AspNetCore.Http;\nusing Microsoft.Extensions.Logging;\nusing Microsoft.Azure.Cosmos;\nusing System.Text.Json;\nusing System.IO; // Added this line\n\nnamespace TaskManagerFunctions\n{\n    public class TaskItem\n    {\n        public string id { get; set; } = System.Guid.NewGuid().ToString();\n        public string Title { get; set; }\n        public string Description { get; set; }\n        public string DueDate { get; set; }\n    }\n\n    public static class CreateTask\n    {\n        [FunctionName(\"CreateTask\")]\n        public static async Task&lt;IActionResult&gt; Run(\n            [HttpTrigger(AuthorizationLevel.Function, \"post\", Route = null)] HttpRequest req,\n            [CosmosDB(databaseName: \"TasksDB\", containerName: \"Tasks\", Connection = \"CosmosDBConnection\")] CosmosClient cosmosClient,\n            ILogger log)\n        {\n            log.LogInformation(\"C# HTTP trigger function processed a request.\");\n\n            string requestBody = await new StreamReader(req.Body).ReadToEndAsync();\n            var task = JsonSerializer.Deserialize&lt;TaskItem&gt;(requestBody);\n\n            if (task == null || string.IsNullOrEmpty(task.Title) || string.IsNullOrEmpty(task.DueDate))\n            {\n                return new BadRequestObjectResult(\"Please provide a valid task with Title and DueDate.\");\n            }\n\n            var container = cosmosClient.GetContainer(\"TasksDB\", \"Tasks\");\n            await container.CreateItemAsync(task);\n\n            return new OkObjectResult(\"Task created successfully.\");\n        }\n    }\n}\n</code></pre>"},{"location":"app1/#add-the-connection-string-to-the-function-app","title":"Add the Connection String to the Function App:","text":"<ol> <li>In the Portal, Go to your Function App. Settings &gt; Environment Variables</li> <li>Click Add</li> <li>Name: CosmosDBConnection.</li> <li>Value: Paste the PRIMARY CONNECTION STRING from Cosmos DB.</li> <li>Click Apply twice and confirm to make sure its saved.</li> </ol>"},{"location":"app1/#redeploy-the-functionapp","title":"Redeploy the FunctionApp","text":"<pre><code>func azure functionapp publish taskmanagerfunc-yourname\n</code></pre>"},{"location":"app1/#send-a-test","title":"Send a Test","text":"<p>You could use POSTMAN or a CURL Command Use the key from before.  If you need help getting that again run</p> <pre><code>az functionapp function keys list --resource-group az204exam --name taskmanagerfunc-yourname --function-name CreateTask\n</code></pre> <p>Feel free to send any message that makes sense to you</p> <pre><code>curl -X POST -H \"Content-Type: application/json\" -d '{\"Title\":\"Study AZ-204\",\"Description\":\"Review Cosmos DB\",\"DueDate\":\"2025-04-15\"}' \"https://taskmanagerfunc-jwashburn.azurewebsites.net/api/createtask?code=YOURCODEFROMBEFORE==\"\n</code></pre> <p>Go into the Azure Portal &gt; CosmosDB and drill down using Data Explorer and find your item </p>"},{"location":"app1/#you-have-completed-the-add-the-connection-string-to-the-function-app-section","title":"You have completed the Add the Connection String to the Function App Section.","text":""},{"location":"app1/#update-the-homecontroller-with-the-function-app-changes","title":"Update the HomeController with the Function App changes.","text":"<p>Now we need to add some more settings to Environment Variables and update HomeController.cs</p> <p>Go to the Azure Portal and go to your Web App.  Service &gt; Setting &gt; Environment Variables</p> <p>Add 2 settings</p> <ul> <li>Name: FunctionSettings__CreateTaskUrl</li> <li> <p>Value: https://taskmanagerfunc-yourname.azurewebsites.net/api/createtask</p> </li> <li> <p>Name: FunctionSettings__FunctionKey</p> </li> <li>Value: USE_YOUR_KEY_HERE</li> </ul> <p>Replace all the code in TaskManagerWeb/Controllers/HomeController.cs with this code</p> <pre><code>using Microsoft.AspNetCore.Mvc;\nusing TaskManagerWeb.Models;\nusing System.Collections.Generic;\nusing System.Net.Http;\nusing System.Text;\nusing System.Text.Json;\nusing System.Threading.Tasks;\n\nnamespace TaskManagerWeb.Controllers\n{\n    public class HomeController : Controller\n    {\n        private static List&lt;TaskItem&gt; _tasks = new List&lt;TaskItem&gt;(); // Temporary in-memory storage\n        private readonly HttpClient _httpClient;\n        private readonly string _functionUrl;\n\n        public HomeController(IHttpClientFactory httpClientFactory, IConfiguration configuration)\n        {\n            _httpClient = httpClientFactory.CreateClient();\n            var baseUrl = configuration[\"FunctionSettings:CreateTaskUrl\"];\n            var functionKey = configuration[\"FunctionSettings:FunctionKey\"];\n            _functionUrl = $\"{baseUrl}?code={functionKey}\";\n        }\n\n        public IActionResult Index()\n        {\n            return View(_tasks);\n        }\n\n        [HttpPost]\n        public async Task&lt;IActionResult&gt; Create(string title, string description, string dueDate)\n        {\n            var task = new TaskItem\n            {\n                Title = title,\n                Description = description,\n                DueDate = dueDate\n            };\n\n            var content = new StringContent(JsonSerializer.Serialize(task), Encoding.UTF8, \"application/json\");\n            var response = await _httpClient.PostAsync(_functionUrl, content);\n\n            if (response.IsSuccessStatusCode)\n            {\n                _tasks.Add(task); // Still using in-memory for display; later replace with Cosmos DB read\n                return RedirectToAction(\"Index\");\n            }\n\n            ModelState.AddModelError(\"\", \"Failed to create task.\");\n            return View(\"Index\", _tasks);\n        }\n    }\n}\n</code></pre> <p>Rebuild the app to get the changes into the code.</p> <p>Make sure you are in your TaskManagerWeb directory</p> <pre><code>dotnet build\n</code></pre> <p>Push the changes up to Azure</p> <pre><code>az webapp up --name taskmanagerweb-jwashburn --resource-group az204exam --sku F1 --location westus\n</code></pre>"},{"location":"app1/#you-have-completed-the-update-the-homecontroller-with-the-function-app-changes-section","title":"You have completed the Update the HomeController with the Function App changes Section.","text":""},{"location":"app1/#add-blob-storage","title":"Add Blob Storage","text":"<p>In the Azure Portal Create a new Storage account</p> <p>Look through the tabs for learning, but leave as default.</p> <p></p>"},{"location":"app1/#add-a-container","title":"Add a Container","text":"<ul> <li>Data_Storage&gt; Containers.  Add a Container</li> <li>Name: attachments.</li> <li>Go to Access Keys and copy the Connection String for Key1</li> </ul>"},{"location":"app1/#add-the-keys-to-your-function-app","title":"Add the keys to your Function App","text":"<ul> <li>Settings &gt; Environment Variables</li> <li>Add a new application setting:</li> <li>Name: BlobStorageConnectionString.</li> <li>Value: Paste the Blob Storage connection string from the previous step</li> </ul>"},{"location":"app1/#you-have-completed-the-add-blob-storage-section","title":"You have completed the Add Blob Storage Section.","text":""},{"location":"app1/#update-the-createtask-function-to-handle-file-uploads","title":"Update the CreateTask Function to Handle File Uploads","text":"<p>In the TaskManagerFunctions directory, add the Blob Storage SDK</p> <pre><code>dotnet add package Azure.Storage.Blobs\ndotnet add package Microsoft.Azure.WebJobs.Extensions.Storage\n</code></pre> <p>Update CreateTask.cs to handle a file upload and store it in Blob Storage:</p> <pre><code>using System.Threading.Tasks;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.Azure.WebJobs;\nusing Microsoft.Azure.WebJobs.Extensions.Http;\nusing Microsoft.AspNetCore.Http;\nusing Microsoft.Extensions.Logging;\nusing Microsoft.Azure.Cosmos;\nusing System.Text.Json;\nusing System.IO;\nusing Azure.Storage.Blobs;\n\nnamespace TaskManagerFunctions\n{\n    public class TaskItem\n    {\n        public string id { get; set; } = System.Guid.NewGuid().ToString();\n        public string Title { get; set; }\n        public string Description { get; set; }\n        public string DueDate { get; set; }\n        public string AttachmentUrl { get; set; } // Add this to store the Blob URL\n    }\n\n    public static class CreateTask\n    {\n        [FunctionName(\"CreateTask\")]\n        public static async Task&lt;IActionResult&gt; Run(\n            [HttpTrigger(AuthorizationLevel.Function, \"post\", Route = null)] HttpRequest req,\n            [CosmosDB(databaseName: \"TasksDB\", containerName: \"Tasks\", Connection = \"CosmosDBConnection\")] CosmosClient cosmosClient,\n            [Blob(\"attachments\", Connection = \"BlobStorageConnectionString\")] BlobContainerClient blobContainerClient,\n            ILogger log)\n        {\n            log.LogInformation(\"C# HTTP trigger function processed a request.\");\n\n            if (!req.HasFormContentType)\n            {\n                return new BadRequestObjectResult(\"Please send a multipart form request.\");\n            }\n\n            var form = await req.ReadFormAsync();\n            var title = form[\"title\"];\n            var description = form[\"description\"];\n            var dueDate = form[\"dueDate\"];\n\n            if (string.IsNullOrEmpty(title) || string.IsNullOrEmpty(dueDate))\n            {\n                return new BadRequestObjectResult(\"Please provide a valid task with Title and DueDate.\");\n            }\n\n            var task = new TaskItem\n            {\n                Title = title,\n                Description = description,\n                DueDate = dueDate\n            };\n\n            // Handle file upload\n            var files = form.Files;\n            if (files.Count &gt; 0)\n            {\n                var file = files[0];\n                if (file.Length &gt; 0)\n                {\n                    var blobName = $\"{task.id}/{file.FileName}\";\n                    var blobClient = blobContainerClient.GetBlobClient(blobName);\n                    using (var stream = file.OpenReadStream())\n                    {\n                        await blobClient.UploadAsync(stream, overwrite: true);\n                    }\n                    task.AttachmentUrl = blobClient.Uri.ToString();\n                }\n            }\n\n            var container = cosmosClient.GetContainer(\"TasksDB\", \"Tasks\");\n            await container.CreateItemAsync(task);\n\n            return new OkObjectResult(\"Task created successfully.\");\n        }\n    }\n}\n</code></pre>"},{"location":"app1/#redeploy-the-function","title":"Redeploy the Function","text":"<p>Deploy the updated Function:</p> <pre><code>func azure functionapp publish taskmanagerfunc-jwashburn\n</code></pre>"},{"location":"app1/#you-have-completed-the-createtask-function-to-handle-file-uploads-section","title":"You have completed the CreateTask Function to Handle File Uploads Section.","text":""},{"location":"app1/#update-files-to-support-file-uploads","title":"Update files to support File Uploads:","text":""},{"location":"app1/#update-the-web-app-form-to-include-file-upload","title":"Update the Web App Form to Include File Upload","text":"<ul> <li>Open TaskManagerWeb/Views/Home/Index.cshtml and change your code to this</li> </ul> <pre><code>@model List&lt;TaskManagerWeb.Models.TaskItem&gt;\n\n&lt;h1&gt;Task Manager&lt;/h1&gt;\n\n&lt;form asp-action=\"Create\" method=\"post\" enctype=\"multipart/form-data\"&gt;\n    &lt;div&gt;\n        &lt;label&gt;Title:&lt;/label&gt;\n        &lt;input type=\"text\" name=\"title\" required /&gt;\n    &lt;/div&gt;\n    &lt;div&gt;\n        &lt;label&gt;Description:&lt;/label&gt;\n        &lt;textarea name=\"description\"&gt;&lt;/textarea&gt;\n    &lt;/div&gt;\n    &lt;div&gt;\n        &lt;label&gt;Due Date:&lt;/label&gt;\n        &lt;input type=\"date\" name=\"dueDate\" required /&gt;\n    &lt;/div&gt;\n    &lt;div&gt;\n        &lt;label&gt;Attachment:&lt;/label&gt;\n        &lt;input type=\"file\" name=\"attachment\" /&gt;\n    &lt;/div&gt;\n    &lt;button type=\"submit\"&gt;Add Task&lt;/button&gt;\n&lt;/form&gt;\n\n&lt;h2&gt;Tasks&lt;/h2&gt;\n&lt;ul&gt;\n    @if (Model != null &amp;&amp; Model.Any())\n    {\n        foreach (var task in Model)\n        {\n            &lt;li&gt;\n                @task.Title - @task.Description (Due: @(task.DueDate ?? \"No due date\"))\n                @if (!string.IsNullOrEmpty(task.AttachmentUrl))\n                {\n                    &lt;a href=\"@task.AttachmentUrl\" target=\"_blank\"&gt;View Attachment&lt;/a&gt;\n                }\n            &lt;/li&gt;\n        }\n    }\n    else\n    {\n        &lt;li&gt;No tasks yet.&lt;/li&gt;\n    }\n&lt;/ul&gt;\n</code></pre>"},{"location":"app1/#update-homecontrollercs-to-handle-file-upload","title":"Update HomeController.cs to Handle File Upload:","text":"<ul> <li>Update TaskMangerWeb/Controllers/HomeController.cs to send the form data (including the file) to the Function with these code changes:</li> </ul> <pre><code>using Microsoft.AspNetCore.Mvc;\nusing TaskManagerWeb.Models;\nusing System.Collections.Generic;\nusing System.Net.Http;\nusing System.Threading.Tasks;\n\nnamespace TaskManagerWeb.Controllers\n{\n    public class HomeController : Controller\n    {\n        private static List&lt;TaskItem&gt; _tasks = new List&lt;TaskItem&gt;(); // Temporary in-memory storage\n        private readonly HttpClient _httpClient;\n        private readonly string _functionUrl;\n\n        public HomeController(IHttpClientFactory httpClientFactory, IConfiguration configuration)\n        {\n            _httpClient = httpClientFactory.CreateClient();\n            var baseUrl = configuration[\"FunctionSettings:CreateTaskUrl\"];\n            var functionKey = configuration[\"FunctionSettings:FunctionKey\"];\n            _functionUrl = $\"{baseUrl}?code={functionKey}\";\n        }\n\n        public IActionResult Index()\n        {\n            return View(_tasks);\n        }\n\n        [HttpPost]\n        public async Task&lt;IActionResult&gt; Create(string title, string description, string dueDate, IFormFile attachment)\n        {\n            var formData = new MultipartFormDataContent();\n            formData.Add(new StringContent(title ?? \"\"), \"title\");\n            formData.Add(new StringContent(description ?? \"\"), \"description\");\n            formData.Add(new StringContent(dueDate ?? \"\"), \"dueDate\");\n\n            if (attachment != null &amp;&amp; attachment.Length &gt; 0)\n            {\n                var fileContent = new StreamContent(attachment.OpenReadStream());\n                fileContent.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue(attachment.ContentType);\n                formData.Add(fileContent, \"attachment\", attachment.FileName);\n            }\n\n            var response = await _httpClient.PostAsync(_functionUrl, formData);\n\n            if (response.IsSuccessStatusCode)\n            {\n                var task = new TaskItem\n                {\n                    Title = title,\n                    Description = description,\n                    DueDate = dueDate\n                };\n                _tasks.Add(task); // Still using in-memory for display; later replace with Cosmos DB read\n                return RedirectToAction(\"Index\");\n            }\n\n            ModelState.AddModelError(\"\", \"Failed to create task.\");\n            return View(\"Index\", _tasks);\n        }\n    }\n}\n</code></pre>"},{"location":"app1/#update-taskitemcs-to-include-attachmenturl","title":"Update TaskItem.cs to Include AttachmentUrl:","text":"<ul> <li>Open TaskManagerWeb/Models/TaskItem.cs and make these changes:</li> </ul> <pre><code>namespace TaskManagerWeb.Models\n{\n    public class TaskItem\n    {\n        public string id { get; set; } = System.Guid.NewGuid().ToString();\n        public string? Title { get; set; }\n        public string? Description { get; set; }\n        public string? DueDate { get; set; }\n        public string? AttachmentUrl { get; set; } // Add this\n    }\n}\n</code></pre> <ul> <li> <p>Change back to the TaskManagerWeb Directory and push up the change</p> </li> <li> <p>Adjust TaskManagerWeb/Program.cs to include the AddHttpClient</p> </li> </ul> <pre><code>using Microsoft.AspNetCore.Builder;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.Hosting;\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container\nbuilder.Services.AddControllersWithViews();\nbuilder.Services.AddHttpClient(); // Register IHttpClientFactory\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Home/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\napp.UseRouting();\napp.UseAuthorization();\n\napp.MapControllerRoute(\n    name: \"default\",\n    pattern: \"{controller=Home}/{action=Index}/{id?}\");\n\napp.Run();\n</code></pre> <pre><code>az webapp up --name taskmanagerweb-jwashburn --resource-group az204exam --sku F1 --location westus\n</code></pre>"},{"location":"app1/#application-insights","title":"Application Insights","text":"<p>At this point you are likely hitting app errors and other problems as this code is AI generated and not tested at any real level of scrutiny.  So lets get App Insights going to help troubleshoot the problem</p>"},{"location":"app1/#create-application-insights","title":"Create Application Insights","text":"<p>In the Azure Portal create an Appliction Insights resource - Use the same resource group you have been using - Setup a name like taskmanager-insights - Leave the rest defaults - Retrieve the Connection String -- Go to the new Application Insights resource &gt; Overview tab. - Copy the Connection String (e.g., InstrumentationKey=...;IngestionEndpoint=...). - Save this for later we are going to need it.</p>"},{"location":"app1/#integrate-with-app-service","title":"Integrate with App Service","text":"<p>Navigate to the TaskManagerWeb directory and add the required package</p> <pre><code>dotnet add package Microsoft.ApplicationInsights.AspNetCore\n</code></pre> <p>Modify TaskManagerWeb/Program.cs to initialize Application Insights.</p> <p>Replace the existing code with</p> <pre><code>using Microsoft.AspNetCore.Builder;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.Hosting;\nusing Microsoft.ApplicationInsights.AspNetCore.Extensions; // Add this\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container\nbuilder.Services.AddControllersWithViews();\nbuilder.Services.AddHttpClient();\n\n// Add Application Insights\nbuilder.Services.AddApplicationInsightsTelemetry();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Home/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\napp.UseRouting();\napp.UseAuthorization();\n\napp.MapControllerRoute(\n    name: \"default\",\n    pattern: \"{controller=Home}/{action=Index}/{id?}\");\n\napp.Run();\n</code></pre>"},{"location":"app1/#add-connection-string-to-app-service","title":"Add Connection String to App Service","text":"<ul> <li>In the Azure Portal, go to your App Service (taskmanagerweb-yourname).</li> <li>Navigate to Settings &gt; Environment Variables (or Configuration).</li> <li>Add a new application setting:</li> <li>Name: APPLICATIONINSIGHTS_CONNECTION_STRING</li> <li>Value: Paste the Connection String from Step 1.</li> </ul>"},{"location":"app1/#redeploy-the-web-app","title":"Redeploy the Web App","text":"<ul> <li>Ensure you\u2019re in the TaskManagerWeb directory</li> </ul> <pre><code>cd TaskManagerWeb\ndotnet build\naz webapp up --name taskmanagerweb-yourname --resource-group az204exam --sku F1 --location westus\n</code></pre>"},{"location":"app1/#you-have-completed-the-add-app-insights-to-app-service-section","title":"You have completed the Add App Insights to App Service Section.","text":""},{"location":"app1/#integrate-with-azure-function","title":"Integrate with Azure Function","text":"<ul> <li>Add the Application Insights SDK:</li> <li>In the TaskManagerFunctions directory:</li> </ul> <pre><code>dotnet add package Microsoft.Azure.WebJobs.Logging.ApplicationInsights\n</code></pre> <ul> <li>Add Connection String to Function App:</li> <li>In the Azure Portal, go to your Function App (taskmanagerfunc-yourname).</li> <li>Navigate to Settings &gt; Environment Variables.</li> <li>Add a new application setting:</li> <li>Name: APPLICATIONINSIGHTS_CONNECTION_STRING</li> <li>Value: Paste the same Connection String from Step 1.</li> </ul>"},{"location":"app1/#redeploy-the-function-app","title":"Redeploy the Function App:","text":"<ul> <li>Ensure you\u2019re in the TaskManagerFunctions directory:</li> </ul> <pre><code>cd TaskManagerFunctions\nfunc azure functionapp publish taskmanagerfunc-yourname\n</code></pre>"},{"location":"app1/#go-test-in-azure","title":"Go Test in Azure","text":"<p>STILL to DO AD Auth App Insights</p>"},{"location":"app1/#cost-estimate","title":"Cost Estimate","text":"<ul> <li>App Service:  Free (F1 tier).</li> <li>Azure Functions: ~$0.05\u2013$0.10 (Consumption plan, light usage).</li> <li>Cosmos DB: Free (1000 RU/s tier).</li> <li>Blob Storage: ~$0.05\u2013$0.10 (minimal storage/transactions).</li> <li>Azure AD/Application Insights: Free.</li> </ul>"},{"location":"app1/#total-010025-for-initial-setup-and-testing-well-within-200-credit","title":"Total: ~$0.10\u2013$0.25 for initial setup and testing, well within $200 credit.","text":""},{"location":"app1/#learning-outcomes","title":"Learning Outcomes","text":"<ul> <li>Deploy and configure Azure App Service and Functions.</li> <li>Work with Cosmos DB for NoSQL data and Blob Storage for files.</li> <li>Implement authentication and RBAC.</li> <li>Monitor apps with Application Insights</li> </ul>"}]}